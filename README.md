# kursovay_rabota_PA
```
name_file
-all : tokens, AST, table symbol/
-m : generate .asm for MARS
gram/safron.g4
```
```
VAR INT i;

DEF VOID f(INT x);
VAR INT c;
{
   c = x % 2;
   x = x / 2;
   IF(x > 0) THEN
   {
      f(x);
   }
   PRINT(c);

};

{
    i = 10;
    f(i);
    PRINT("\n");
    f(127);
}.
```
Tokens:
```
Tokens: 
[@0,0:2='VAR',<13>,1:0]
[@1,4:6='INT',<2>,1:4]
[@2,8:8='i',<43>,1:8]
[@3,9:9=';',<26>,1:9]
[@4,14:16='DEF',<19>,3:0]
[@5,18:21='VOID',<20>,3:4]
[@6,23:23='f',<43>,3:9]
[@7,24:24='(',<39>,3:10]
[@8,25:27='INT',<2>,3:11]
[@9,29:29='x',<43>,3:15]
[@10,30:30=')',<40>,3:16]
[@11,31:31=';',<26>,3:17]
[@12,34:36='VAR',<13>,4:0]
[@13,38:40='INT',<2>,4:4]
[@14,42:42='c',<43>,4:8]
[@15,43:43=';',<26>,4:9]
[@16,46:46='{',<41>,5:0]
[@17,52:52='c',<43>,6:3]
[@18,54:54='=',<24>,6:5]
[@19,56:56='x',<43>,6:7]
[@20,58:58='%',<32>,6:9]
[@21,60:60='2',<44>,6:11]
[@22,61:61=';',<26>,6:12]
[@23,67:67='x',<43>,7:3]
[@24,69:69='=',<24>,7:5]
[@25,71:71='x',<43>,7:7]
[@26,73:73='/',<31>,7:9]
[@27,75:75='2',<44>,7:11]
[@28,76:76=';',<26>,7:12]
[@29,82:83='IF',<7>,8:3]
[@30,84:84='(',<39>,8:5]
[@31,85:85='x',<43>,8:6]
[@32,87:87='>',<38>,8:8]
[@33,89:89='0',<44>,8:10]
[@34,90:90=')',<40>,8:11]
[@35,92:95='THEN',<8>,8:13]
[@36,101:101='{',<41>,9:3]
[@37,110:110='f',<43>,10:6]
[@38,111:111='(',<39>,10:7]
[@39,112:112='x',<43>,10:8]
[@40,113:113=')',<40>,10:9]
[@41,114:114=';',<26>,10:10]
[@42,120:120='}',<42>,11:3]
[@43,126:130='PRINT',<4>,12:3]
[@44,131:131='(',<39>,12:8]
[@45,132:132='c',<43>,12:9]
[@46,133:133=')',<40>,12:10]
[@47,134:134=';',<26>,12:11]
[@48,139:139='}',<42>,14:0]
[@49,140:140=';',<26>,14:1]
[@50,145:145='{',<41>,16:0]
[@51,152:152='i',<43>,17:4]
[@52,154:154='=',<24>,17:6]
[@53,156:157='10',<44>,17:8]
[@54,158:158=';',<26>,17:10]
[@55,165:165='f',<43>,18:4]
[@56,166:166='(',<39>,18:5]
[@57,167:167='i',<43>,18:6]
[@58,168:168=')',<40>,18:7]
[@59,169:169=';',<26>,18:8]
[@60,176:180='PRINT',<4>,19:4]
[@61,181:181='(',<39>,19:9]
[@62,182:185='"\n"',<46>,19:10]
[@63,186:186=')',<40>,19:14]
[@64,187:187=';',<26>,19:15]
[@65,194:194='f',<43>,20:4]
[@66,195:195='(',<39>,20:5]
[@67,196:198='127',<44>,20:6]
[@68,199:199=')',<40>,20:9]
[@69,200:200=';',<26>,20:10]
[@70,203:203='}',<42>,21:0]
[@71,204:204='.',<1>,21:1]
[@72,205:204='<EOF>',<-1>,21:2]
```
Syntax:
![image](https://user-images.githubusercontent.com/57590741/170657311-633aae4e-bc56-4921-a1ff-c2d80faaa7d3.png)


ASM:
```
.data
str1 :	.asciiz "\n"
i : 	.word 0
f_c : 	.word 0
f_x : 	.word 0


.text
.globl main

main : 
	li, $s0, 10
	sw, $s0, i
	lw, $a0, i
	jal, f

L1 : 
	li, $v0, 4
	la, $a0, str1
	syscall
	li, $a0, 127
	jal, f

L2 : 
	li, $v0, 10
	syscall

f : 
	sw, $a0, f_x

f_L1 : 
	lw, $s0, f_x
	li, $s1, 2
	div, $t1, $s0, $s1
	mfhi, $t1
	sw, $t1, f_c

f_L2 : 
	lw, $s0, f_x
	li, $s1, 2
	div, $t1, $s0, $s1
	sw, $t1, f_x

f_L3 : 
	lw, $s0, f_x
	li, $s1, 0
	sgt, $t1, $s0, $s1
	beq, $t1, $zero, f_L4
	lw, $a0, f_x
	addi, $sp, $sp, -12
	sw, $ra, 8($sp)
	lw, $s0, f_c
	sw, $s0, 4($sp)
	lw, $s0, f_x
	sw, $s0, 0($sp)
	jal, f
	lw, $ra, 8($sp)
	lw, $s0, 4($sp)
	sw, $s0, f_c
	lw, $s0, 0($sp)
	sw, $s0, f_x
	addi, $sp, $sp, 12

f_L4 : 
	li, $v0, 1
	lw, $a0, f_c
	syscall

f_L5 : 
	jr, $ra

```
MARS:

![image](https://user-images.githubusercontent.com/57590741/170657755-19aa27bb-1abd-4bb4-a71b-10e593be78a9.png)


